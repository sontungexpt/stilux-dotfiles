const versionElName="#js-ext-version",selectThemeElName='#js-select-theme input:radio[name="theme"]',selectFontElName="#js-select-font",manifestData=window.zadark.browser.getManifest(),MSG_ACTIONS={GET_ENABLED_BLOCKING_RULE_IDS:"@ZaDark:GET_ENABLED_BLOCKING_RULE_IDS",UPDATE_ENABLED_BLOCKING_RULE_IDS:"@ZaDark:UPDATE_ENABLED_BLOCKING_RULE_IDS"};$(versionElName).html(`Phiên bản ${manifestData.version}`),window.zadark.utils.refreshPageTheme(),window.zadark.utils.refreshPageFont(),window.zadark.browser.getExtensionSettings().then(({theme:e,font:a})=>{$(selectThemeElName).filter(`[value="${e}"]`).attr("checked",!0),$(selectFontElName).val(a)}),$(selectThemeElName).on("change",async function(){const e=$(this).val();await window.zadark.browser.saveExtensionSettings({theme:e}),window.zadark.utils.refreshPageTheme(),window.zadark.browser.sendMessage2ZaloTabs("@ZaDark:CHANGE_THEME",{theme:e})}),$(selectFontElName).on("change",async function(){const e=$(this).val();await window.zadark.browser.saveExtensionSettings({font:e}),window.zadark.browser.sendMessage2ZaloTabs("@ZaDark:CHANGE_FONT",{font:e})});const handleBlockingRuleChange=(e,a)=>()=>{const s=$(e).is(":checked")?{enableRulesetIds:[a]}:{disableRulesetIds:[a]};chrome.runtime.sendMessage({action:MSG_ACTIONS.UPDATE_ENABLED_BLOCKING_RULE_IDS,payload:s})},initPrivacy=()=>{const e=window.zadark.utils.getIsSupportPrivacy();if(!e)return $("#js-privacy-not-available").html(`Chưa hỗ trợ trên ${window.zadark.browser.name}`),void $("#js-panel-privacy").addClass("not-available");chrome.runtime.sendMessage({action:MSG_ACTIONS.GET_ENABLED_BLOCKING_RULE_IDS}).then(e=>{Array.isArray(e)&&($("#js-switch-block-typing").prop("checked",e.includes("rules_block_typing")),$("#js-switch-block-seen").prop("checked",e.includes("rules_block_seen")),$("#js-switch-block-delivered").prop("checked",e.includes("rules_block_delivered")))}),$("#js-switch-block-typing").on("change",handleBlockingRuleChange("#js-switch-block-typing","rules_block_typing")),$("#js-switch-block-seen").on("change",handleBlockingRuleChange("#js-switch-block-seen","rules_block_seen")),$("#js-switch-block-delivered").on("change",handleBlockingRuleChange("#js-switch-block-delivered","rules_block_delivered"))};initPrivacy();